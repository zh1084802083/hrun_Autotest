config:
    name: 新建合同
    variables:
        access_token: ${get_token()}
        areaSize: ${str_to_int(10)}
        room_number: ${random_int(101,199)}
    verify: false
    export:
        - room_id
        - building_id
        - contract_id
        - customerId
teststeps:
-   name: 获取用户id
    testcase: testcases/Auth/user_info.yml

-   name: 获取楼宇id
    testcase: testcases/Buildings/buildings.yml

-   name: 新增可招商房源
    request:
        headers:
            accept: application/json
            authorization: Bearer $access_token
        json:
            areaSize: $areaSize
            buildingId: $building_id
            cubicleUpdateRequests: []
            floorName: '1'
            jsonData: '[{"required":false,"fieldName":"建筑面积","fieldType":"NUMBER","systemField":true},{"required":false,"fieldName":"装修","fieldType":"SINGLE_SELECT","values":["不限","毛坯","简装","精装"],"systemField":true},{"required":false,"fieldName":"预租单价","fieldType":"NUMBER","systemField":true}]'
            marketingAvailable: 'true'
            realAreaSize: $areaSize
            roomNumber: $room_number
            spaceType: ROOM
        method: POST
        url: ${ENV(api_url)}/buildings/$building_id/rooms
    extract:
        - room_id: content
    validate:
    -   eq:
        - status_code
        - 201

-   name: 生成房源合同租金明细
    request:
        headers:
            authorization: Bearer $access_token
        json:
            baseTerm:
                areaSize: $areaSize
                calculateOrder: AREA_FIRST
                deposit: 1
                depositPayEnumDesc: 租金保证金
                depositUnitEnum: MONTH
                leaseBeginDate: ${begin_date()}
                leaseEndDate: ${end_date()}
                monetaryUnit: 人民币CNY
                precisionEnum: RESULT
                signDate: ${begin_date()}
                spaceUnit: P
                theoryRounded: false
                unitPricePrecision: 2
            depositIncreasingRates: []
            discounts: []
            increasingRates: []
            leaseTerms:
            -   calculateEnum: MONTH
                dayNumberForYear: 365
                deposit: false
                intervalMonth: 1
                leaseComputeWay: FIXED_MONEY
                leaseDivideRoleEnum: NORMAL
                leaseTermType: RENT
                leaseTermTypeDesc: 租金
                monetaryUnit: 人民币CNY
                payInAdvanceDay: 1
                paymentDateEnum: WORKDAY
                price: 10
                priceUnitEnum: D
                termBeginDate: ${begin_date()}
                termEndDate: ${end_date()}
        method: POST
        url: ${ENV(api_url)}/v2/contracts/pays
    extract:
        - theoryPayDate_0: content.0.theoryPayDate
        - theoryPayDate_1: content.1.theoryPayDate
        - theoryPayDate_2: content.2.theoryPayDate
        - theoryPayDate_3: content.3.theoryPayDate
        - theoryPayDate_4: content.4.theoryPayDate
        - theoryPayDate_5: content.5.theoryPayDate
        - theoryPayDate_6: content.6.theoryPayDate
        - theoryPayDate_7: content.7.theoryPayDate
        - theoryPayDate_8: content.8.theoryPayDate
        - theoryPayDate_9: content.9.theoryPayDate
        - theoryPayDate_10: content.10.theoryPayDate
        - theoryPayDate_11: content.11.theoryPayDate
        - theoryPayDate_12: content.12.theoryPayDate
        - startDate_0: content.0.startDate
        - startDate_1: content.1.startDate
        - startDate_2: content.2.startDate
        - startDate_3: content.3.startDate
        - startDate_4: content.4.startDate
        - startDate_5: content.5.startDate
        - startDate_6: content.6.startDate
        - startDate_7: content.7.startDate
        - startDate_8: content.8.startDate
        - startDate_9: content.9.startDate
        - startDate_10: content.10.startDate
        - startDate_11: content.11.startDate
        - startDate_12: content.12.startDate
        - endDate_0: content.0.endDate
        - endDate_1: content.1.endDate
        - endDate_2: content.2.endDate
        - endDate_3: content.3.endDate
        - endDate_4: content.4.endDate
        - endDate_5: content.5.endDate
        - endDate_6: content.6.endDate
        - endDate_7: content.7.endDate
        - endDate_8: content.8.endDate
        - endDate_9: content.9.endDate
        - endDate_10: content.10.endDate
        - endDate_11: content.11.endDate
        - endDate_12: content.12.endDate
        - finalPrice_0: content.0.finalPrice
        - finalPrice_1: content.1.finalPrice
        - finalPrice_2: content.2.finalPrice
        - finalPrice_3: content.3.finalPrice
        - finalPrice_4: content.4.finalPrice
        - finalPrice_5: content.5.finalPrice
        - finalPrice_6: content.6.finalPrice
        - finalPrice_7: content.7.finalPrice
        - finalPrice_8: content.8.finalPrice
        - finalPrice_9: content.9.finalPrice
        - finalPrice_10: content.10.finalPrice
        - finalPrice_11: content.11.finalPrice
        - finalPrice_12: content.12.finalPrice
        - theoryPayMoney_0: content.0.theoryPayMoney
        - theoryPayMoney_1: content.1.theoryPayMoney
        - theoryPayMoney_2: content.2.theoryPayMoney
        - theoryPayMoney_3: content.3.theoryPayMoney
        - theoryPayMoney_4: content.4.theoryPayMoney
        - theoryPayMoney_5: content.5.theoryPayMoney
        - theoryPayMoney_6: content.6.theoryPayMoney
        - theoryPayMoney_7: content.7.theoryPayMoney
        - theoryPayMoney_8: content.8.theoryPayMoney
        - theoryPayMoney_9: content.9.theoryPayMoney
        - theoryPayMoney_10: content.10.theoryPayMoney
        - theoryPayMoney_11: content.11.theoryPayMoney
        - theoryPayMoney_12: content.12.theoryPayMoney
        - payMoney_0: content.0.payMoney
        - payMoney_1: content.1.payMoney
        - payMoney_2: content.2.payMoney
        - payMoney_3: content.3.payMoney
        - payMoney_4: content.4.payMoney
        - payMoney_5: content.5.payMoney
        - payMoney_6: content.6.payMoney
        - payMoney_7: content.7.payMoney
        - payMoney_8: content.8.payMoney
        - payMoney_9: content.9.payMoney
        - payMoney_10: content.10.payMoney
        - payMoney_11: content.11.payMoney
        - payMoney_12: content.12.payMoney
        - commissionStandard_0: content.0.commissionStandard
        - commissionStandard_1: content.1.commissionStandard
        - commissionStandard_2: content.2.commissionStandard
        - commissionStandard_3: content.3.commissionStandard
        - commissionStandard_4: content.4.commissionStandard
        - commissionStandard_5: content.5.commissionStandard
        - commissionStandard_6: content.6.commissionStandard
        - commissionStandard_7: content.7.commissionStandard
        - commissionStandard_8: content.8.commissionStandard
        - commissionStandard_9: content.9.commissionStandard
        - commissionStandard_10: content.10.commissionStandard
        - commissionStandard_11: content.11.commissionStandard
        - commissionStandard_12: content.12.commissionStandard
        - planRentAmount_0: content.0.planRentAmount
        - planRentAmount_1: content.1.planRentAmount
        - planRentAmount_2: content.2.planRentAmount
        - planRentAmount_3: content.3.planRentAmount
        - planRentAmount_4: content.4.planRentAmount
        - planRentAmount_5: content.5.planRentAmount
        - planRentAmount_6: content.6.planRentAmount
        - planRentAmount_7: content.7.planRentAmount
        - planRentAmount_8: content.8.planRentAmount
        - planRentAmount_9: content.9.planRentAmount
        - planRentAmount_10: content.10.planRentAmount
        - planRentAmount_11: content.11.planRentAmount
        - planRentAmount_12: content.12.planRentAmount
    validate:
    -   eq:
        - status_code
        - 200

-   name: 新建房源合同--按面积计算租金
    request:
        headers:
            authorization: Bearer $access_token
            content-type: application/json; charset=utf-8
        json:
            baseTerm:
                areaSize: $areaSize
                calculateOrder: AREA_FIRST
                contractNo: '001'
                leaseBeginDate: ${begin_date()}
                leaseEndDate: ${end_date()}
                precisionEnum: RESULT
                signDate: ${begin_date()}
                spaceUnit: P
                theoryRounded: false
                unitPricePrecision: 2
            contractNo: '001'
            customKeywords: []
            expenseTerms:
            -   areaSize: $areaSize
                buildingType: OFFICE
                contractExpenseTermName: 租赁条款
                contractPays:
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_0
                    payMoney: $payMoney_0
                    planRentAmount: $planRentAmount_0
                    startDate: $startDate_0
                    endDate: $endDate_0
                    theoryPayDate: $theoryPayDate_0
                    theoryPayMoney: $theoryPayMoney_0
                    finalPrice: $finalPrice_0
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: I2N6jRVli
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-1
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 1
                    tempPayMoney: null
                    termIndex: 1
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_1
                    payMoney: $payMoney_1
                    planRentAmount: $planRentAmount_1
                    startDate: $startDate_1
                    endDate: $endDate_1
                    theoryPayDate: $theoryPayDate_1
                    theoryPayMoney: $theoryPayMoney_1
                    finalPrice: $finalPrice_1
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: gH1LTxtjGs
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-2
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 2
                    tempPayMoney: null
                    termIndex: 2
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_2
                    payMoney: $payMoney_2
                    planRentAmount: $planRentAmount_2
                    startDate: $startDate_2
                    endDate: $endDate_2
                    theoryPayDate: $theoryPayDate_2
                    theoryPayMoney: $theoryPayMoney_2
                    finalPrice: $finalPrice_2
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: jwYXJiL2V6
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-3
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 3
                    tempPayMoney: null
                    termIndex: 3
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_3
                    payMoney: $payMoney_3
                    planRentAmount: $planRentAmount_3
                    startDate: $startDate_3
                    endDate: $endDate_3
                    theoryPayDate: $theoryPayDate_3
                    theoryPayMoney: $theoryPayMoney_3
                    finalPrice: $finalPrice_3
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: drF-WA9m8J
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-4
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 4
                    tempPayMoney: null
                    termIndex: 4
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_4
                    payMoney: $payMoney_4
                    planRentAmount: $planRentAmount_4
                    startDate: $startDate_4
                    endDate: $endDate_4
                    theoryPayDate: $theoryPayDate_4
                    theoryPayMoney: $theoryPayMoney_4
                    finalPrice: $finalPrice_4
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: V6sxwlOyIX
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-5
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 5
                    tempPayMoney: null
                    termIndex: 5
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_5
                    payMoney: $payMoney_5
                    planRentAmount: $planRentAmount_5
                    startDate: $startDate_5
                    endDate: $endDate_5
                    theoryPayDate: $theoryPayDate_5
                    theoryPayMoney: $theoryPayMoney_5
                    finalPrice: $finalPrice_5
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: kumgYdAaeu
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-6
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 6
                    tempPayMoney: null
                    termIndex: 6
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_6
                    payMoney: $payMoney_6
                    planRentAmount: $planRentAmount_6
                    startDate: $startDate_6
                    endDate: $endDate_6
                    theoryPayDate: $theoryPayDate_6
                    theoryPayMoney: $theoryPayMoney_6
                    finalPrice: $finalPrice_6
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: akf6GV31in
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-7
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 7
                    tempPayMoney: null
                    termIndex: 7
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_7
                    payMoney: $payMoney_7
                    planRentAmount: $planRentAmount_7
                    startDate: $startDate_7
                    endDate: $endDate_7
                    theoryPayDate: $theoryPayDate_7
                    theoryPayMoney: $theoryPayMoney_7
                    finalPrice: $finalPrice_7
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: 44mFS_h_bs
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-8
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 8
                    tempPayMoney: null
                    termIndex: 8
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_8
                    payMoney: $payMoney_8
                    planRentAmount: $planRentAmount_8
                    startDate: $startDate_8
                    endDate: $endDate_8
                    theoryPayDate: $theoryPayDate_8
                    theoryPayMoney: $theoryPayMoney_8
                    finalPrice: $finalPrice_8
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: tPhz_lDCIC
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-9
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 9
                    tempPayMoney: null
                    termIndex: 9
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_9
                    payMoney: $payMoney_9
                    planRentAmount: $planRentAmount_9
                    startDate: $startDate_9
                    endDate: $endDate_9
                    theoryPayDate: $theoryPayDate_9
                    theoryPayMoney: $theoryPayMoney_9
                    finalPrice: $finalPrice_9
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: GyjZDLxeoV
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-10
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 10
                    tempPayMoney: null
                    termIndex: 10
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_10
                    payMoney: $payMoney_10
                    planRentAmount: $planRentAmount_10
                    startDate: $startDate_10
                    endDate: $endDate_10
                    theoryPayDate: $theoryPayDate_10
                    theoryPayMoney: $theoryPayMoney_10
                    finalPrice: $finalPrice_10
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: 46IOGtf5bD
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-11
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 11
                    tempPayMoney: null
                    termIndex: 11
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_11
                    payMoney: $payMoney_11
                    planRentAmount: $planRentAmount_11
                    startDate: $startDate_11
                    endDate: $endDate_11
                    theoryPayDate: $theoryPayDate_11
                    theoryPayMoney: $theoryPayMoney_11
                    finalPrice: $finalPrice_11
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: false
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: 62IfbMguRm
                    monetaryUnit: 人民币CNY
                    moneyDiscount: true
                    normalIndex: 1-12
                    payEnum: RENT
                    payEnumDesc: 租金
                    priceUnitEnum: D
                    primaryTermIndex: 12
                    tempPayMoney: null
                    termIndex: 12
                -   applyDate: null
                    carryAmount: 0
                    carryForwards: []
                    commissionMoney: 0
                    commissionRateModels: null
                    commissionStandard: $commissionStandard_12
                    payMoney: $payMoney_12
                    planRentAmount: $planRentAmount_12
                    startDate: $startDate_12
                    endDate: $endDate_12
                    theoryPayDate: $theoryPayDate_12
                    theoryPayMoney: $theoryPayMoney_12
                    finalPrice: $finalPrice_12
                    commissionStatus: NONE
                    contractId: null
                    contractPayRentCommission: NORMAL
                    deposit: true
                    generateBills: false
                    id: null
                    increaseNumber: null
                    increaseRateEnum: null
                    key: JS_YnDm8sA
                    monetaryUnit: 人民币CNY
                    moneyDiscount: false
                    normalIndex: null
                    payEnum: RENT_DEPOSIT
                    payEnumDesc: 租金保证金
                    priceUnitEnum: null
                    primaryTermIndex: null
                    tempPayMoney: null
                    termIndex: 13
                deposit: 1
                depositIncreasingRates: []
                depositUnitEnum: MONTH
                discounts: []
                expenseTermType: RENT_TERM
                increasingRates: []
                itemPermission: RENT_PERMISSION
                leaseTerms:
                -   calculateEnum: MONTH
                    dayNumberForYear: 365
                    deposit: false
                    intervalMonth: 1
                    leaseComputeWay: FIXED_MONEY
                    leaseDivideRoleEnum: NORMAL
                    leaseTermType: RENT
                    leaseTermTypeDesc: 租金
                    monetaryUnit: 人民币CNY
                    payInAdvanceDay: 1
                    paymentDateEnum: WORKDAY
                    price: 10
                    priceUnitEnum: D
                    termBeginDate: ${begin_date()}
                    termEndDate: ${end_date()}
                monetaryUnit: 人民币CNY
                resourceIds:
                - $room_id
                resourceType: ROOM
                spaceUnit: P
                termIndex: 1
            followId: 4990
            followName: '13787340624'
            jsonData: '[]'
            legalPerson:
                name: 李传根
            remarkTerms: []
            resourceIds:
            - $room_id
            resourceType: ROOM
            tags: []
            tenantId: 78327
            tenantName: 湖南神雀网络科技有限公司
            tenantNo: null
        method: POST
        url: ${ENV(api_url)}/v3/contracts?
    extract:
        - contract_id: content
    validate:
    -   eq:
        - status_code
        - 201

-   name: 提交合同
    request:
        headers:
            accept: application/json
            authorization: Bearer $access_token
        json:
            buildingIds: [$building_id]
            subDomainType: "NEW_APPROVAL"
            domainType: "CONTRACT"
            customerId: $customerId
            description: "湖南神雀网络科技有限公司/测试楼宇/$room_number"
            objectId: $contract_id
        method: POST
        url: ${ENV(api_url)}/oa/start
    setup_hooks:
        - ${set_contract_sh()}
    validate:
    -   eq:
        - status_code
        - 200